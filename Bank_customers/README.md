## Данные
Исторические данные о поведении клиентов банка и расторжении договоров с ними

## Задача
Нужно спрогнозировать, уйдёт клиент из банка в ближайшее время или нет 

## Технологии
Pandas, Matplotlib, Scikit-learn
## Выводы
**Датасет состоял из 10000 клиентов:** 
- все данные кроме продолжительности обслуживания в годах без пропусков (пропуски в годах обслуживания заполнены медианами)
- отсутствуют неявные дубликаты 
- удалили столбцы с фамилиями и идентификационными номерами, так как не не нужны для обучения модели

**На этапе исследования задачи проведено:**
- кодирование категориальных признаков (страна и пол клиента) методом OHE
- масштабироввание численных признаков (кредитный рейтинг, возраст, продолжительность обслуживания, баланс на счете, количество используемых продуктов банка, предполагаемая зарплата)
- без учета дисбаланса классов обучены модели: логическая регрессия, случайный лес, дерево решений. Наилучшие показатели F1 меры получены на моделе Случайный лес = 0.60

На этапе работы с дисбалансом классов испробованы 3 метода на трех моделях:

**Случайный лес:**

- взвешивание, F1=0.63, AUC-ROC = 0.86 (est 47, depth 8)
- увеличение выборки, F1=0.62, AUC-ROC = 0.84 (est 45, depth 7)
- уменьшение выборки, F1 = 0.60, AUC-ROC = 0.84, (est 13, depth 6)

**Дерево решений:**

- взвешивание, F1=0.60, AUC-ROC = 0.83 (depth 5)
- увеличение выборки, F1=0.58, AUC-ROC = 0.83 (depth 5)
- уменьшение выборки, F1 = 0.59, AUC-ROC = 0.83 (depth 5)

**Логистическая регрессия:**

- взвешивание, F1=0.49, AUC-ROC = 0.76
- увеличение выборки, F1=0.48, AUC-ROC = 0.75
- уменьшение выборки, F1 = 0.49, AUC-ROC = 0.76

Для дальнейшей работы и проверки на тестовой выборке взята модель с наибольшим показателем F1 = 0.63 , взвешивание классов, случайный лес, количество деревьев - 47, максимальная глубина - 8. 

F1 на тестовой выборке = 0.60, построена ROC-кривая и расчитан AUC-ROC (0.84). Таким образом модель показала хорошее качество. 
Также рассчитали полноту = 0.56, то есть модель верно предсказывает более половины фактических представителей положительного класса (тех, кто планирует расторгнуть договор с банком)

В заключении расчитали F1 для константной модели, чтобы убедитья, что наша модель работает лучше. Так и есть F1 константной модели = 0.35.
